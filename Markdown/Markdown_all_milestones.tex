\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Data analysis: Project 2 Group 4},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Data analysis: Project 2 Group 4}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{}
    \preauthor{}\postauthor{}
    \date{}
    \predate{}\postdate{}
  

\begin{document}
\maketitle

\hypertarget{molecular-biotechnology-4th-term-summer-2019}{%
\section{Molecular Biotechnology, 4th term, Summer
2019}\label{molecular-biotechnology-4th-term-summer-2019}}

\hypertarget{anna-ann-sophie-und-jana}{%
\subsubsection{Anna, Ann-Sophie und
Jana}\label{anna-ann-sophie-und-jana}}

First of all, a broad analysis containing all samples of the NCI60 panel
with 15 different cancer drugs was performed. In the specific analysis
we focused on the drug erlotinib, which is an inhibitor of EGFR. Three
milestones were defined to analyse which pathways are mostly regulated
due to the drug treatment. The first one included finding the celllines
which have the strongest fold change and the most regulated genes
(biomarkers). Secondly, the correlation between the drug sensitivity of
the various celllines (GI50) and the EGR1 expression was analysed. In
the last part, we analysed the effect of erlotinib on different pathways
using the package PROGENY and illustrating the fold change in gene
expression due to the drug in a heatmap.

\hypertarget{load-data}{%
\subsubsection{Load data}\label{load-data}}

Firstly, the data generated from the NCI60 cellline panel is downloaded
and the various tables are saved as data frames.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NCI_TPW_gep_treated <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14720180?private_link=db1411debcfbe2618d2f"}\NormalTok{))}
\NormalTok{NCI_TPW_gep_untreated <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14720183?private_link=db1411debcfbe2618d2f"}\NormalTok{))}
\NormalTok{NCI_TPW_metadata <-}\StringTok{ }\KeywordTok{read.delim}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14720186?private_link=db1411debcfbe2618d2f"}\NormalTok{)}
\NormalTok{NegLogGI50 <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/ 14720210?private_link=074e0120fe5e682f3d14"}\NormalTok{))}
\NormalTok{CCLE_basalexpression <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14770127?private_link=fc0c71246dc192982a3c"}\NormalTok{))}
\NormalTok{CCLE_copynumber <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14770130?private_link=fc0c71246dc192982a3c"}\NormalTok{))}
\NormalTok{CCLE_mutations <-}\StringTok{ }\KeywordTok{readRDS}\NormalTok{(}\KeywordTok{url}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14770133?private_link=fc0c71246dc192982a3c"}\NormalTok{))}
\NormalTok{cellline_annotation <-}\KeywordTok{read.delim}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14768981?private_link=efb6a529eaf2d4dc6432"}\NormalTok{)}
\NormalTok{drug_annotation <-}\StringTok{ }\KeywordTok{read.delim}\NormalTok{(}\StringTok{"https://ndownloader.figshare.com/files/14768984?private_link=efb6a529eaf2d4dc6432"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{broad-analysis}{%
\subsection{1. Broad analysis}\label{broad-analysis}}

\hypertarget{data-preparation-and-annotation}{%
\subsubsection{Data preparation and
annotation}\label{data-preparation-and-annotation}}

\textbf{Calculate fold change} due to drug treatment\\
The begin of the project includes some preparation of the data and
annotation. Since the gene expression values are already logarithmic,
the fold change caused by the drug can be calculated by substracting the
untreated values (as a control of normal gene expression for each gene
in each cellline) from the treated ones.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fold_changes <-}\StringTok{ }\NormalTok{NCI_TPW_gep_treated }\OperatorTok{-}\StringTok{ }\NormalTok{NCI_TPW_gep_untreated}
\NormalTok{fold_changes <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(fold_changes)}
\end{Highlighting}
\end{Shaded}

\textbf{Renaming of cellline SK-MEL-2}\\
One problem, which occured at the first structuring of the data by using
the grep() function was that the cellline name SK-MEL-2 is part of
cellline SK-MEL\_28. To solve this we renamed that cellline to
SK-MEL-2\_.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#SK-MEL-2_ is added as new factor }
\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name), }
                                                \StringTok{"SK-MEL-2_"}\NormalTok{)}
\NormalTok{cellline_annotation[}\DecValTok{33}\NormalTok{, }\DecValTok{1}\NormalTok{] <-}\StringTok{ "SK-MEL-2_"}
\CommentTok{#delete level SK-MEL-2 (otherwise we would have 62, instead of 61 levels)}
\NormalTok{cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(}
\NormalTok{  cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name))}
\end{Highlighting}
\end{Shaded}

\textbf{Renaming of cancertype Non-Small Cell Lung}\\
To make the legend of the following plots smaller and clearer, we
abbreviate Non-Small Cell Lung with NSCL.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#NSCL is added as new factor }
\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type), }
                                                \StringTok{"NSCL"}\NormalTok{)}
\NormalTok{cellline_annotation[}\KeywordTok{grep}\NormalTok{ (}\StringTok{"Non-Small Cell Lung"}\NormalTok{, cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type), }\StringTok{"Cancer_type"}\NormalTok{] <-}\StringTok{ "NSCL"}
\CommentTok{#delete level Non-Small Cell Lung (otherwise we would have 16, instead of 15 levels)}
\NormalTok{cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(}
\NormalTok{  cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type))}
\end{Highlighting}
\end{Shaded}

\textbf{Annotation} of all sample names\\
A matrix is created, which contains for each sample name the drug,
cellline and cancertype. This matrix is later used for labeling and
coloring of our plots.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Drug
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sample_drug <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(}\KeywordTok{levels}\NormalTok{(drug_annotation}\OperatorTok{$}\NormalTok{Drug), grepl, }
                                    \KeywordTok{colnames}\NormalTok{(fold_changes), }\DataTypeTok{ignore.case =} \OtherTok{TRUE}\NormalTok{))}
  \CommentTok{#creates table with TRUE and FALSE for each sample and drug}
\KeywordTok{rownames}\NormalTok{(sample_drug) <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(fold_changes)}
\NormalTok{drugs <-}\StringTok{ }\KeywordTok{as.vector}\NormalTok{(}\KeywordTok{apply}\NormalTok{(sample_drug, }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x)\{}
  \KeywordTok{colnames}\NormalTok{(sample_drug[}\KeywordTok{which}\NormalTok{(x)])}
\NormalTok{\}))}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Cellline
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sample_cellline <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(}\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name), grepl, }
                                        \KeywordTok{colnames}\NormalTok{(fold_changes), }\DataTypeTok{ignore.case =} \OtherTok{TRUE}\NormalTok{)) }
  \CommentTok{#creates table with TRUE and FALSE for each sample and cellline}
\KeywordTok{rownames}\NormalTok{(sample_cellline) <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(fold_changes)}
\NormalTok{cellline <-}\StringTok{ }\KeywordTok{as.vector}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(}\KeywordTok{apply}\NormalTok{(sample_cellline, }\DecValTok{1}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x)\{}
  \KeywordTok{colnames}\NormalTok{(sample_cellline[}\KeywordTok{which}\NormalTok{(x)])}
\NormalTok{\})))}

\NormalTok{annotation <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(}\StringTok{"Drug"}\NormalTok{ =}\StringTok{ }\NormalTok{drugs, }\StringTok{"Cellline"}\NormalTok{ =}\StringTok{ }\NormalTok{cellline)}
\KeywordTok{rownames}\NormalTok{(annotation) <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(fold_changes)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Cancertype
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cancertype <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(annotation[, }\DecValTok{2}\NormalTok{], }\ControlFlowTok{function}\NormalTok{(x)\{ }
  \CommentTok{#2nd column contains cellline annotation of samples}
\NormalTok{  cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type[cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name }\OperatorTok{==}\StringTok{ }\NormalTok{x]}
\NormalTok{\})}
\NormalTok{cancertype <-}\StringTok{ }\KeywordTok{as.vector}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(cancertype))}


\NormalTok{annotation <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(annotation, }\StringTok{"Cancertype"}\NormalTok{ =}\StringTok{ }\NormalTok{cancertype)}
\KeywordTok{rm}\NormalTok{(drugs, sample_drug, cellline, sample_cellline, cancertype)}
\end{Highlighting}
\end{Shaded}

\textbf{Preparation for Coloring}\\
Create a vector which assigns each drug or each cancertype a color.
These color vectors were used for coloring of the plots and creating the
corresponding legends. For this purpose we searched for a color palette
containing 15 colors, which are easy to distinguish. However, we only
found some like RColorBrewer, which had no palette containing at least
15 distinguishable colors. Therefore we just defined our own
color\_palette by using the names of easily distinguishable colors.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Coloring according to drug (color\_vector\_all\_drugs)
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#define a color palette with 15 chosen colors}
\NormalTok{color_palette_drug <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"aquamarine"}\NormalTok{, }\StringTok{"brown"}\NormalTok{, }\StringTok{"forestgreen"}\NormalTok{, }\StringTok{"slategrey"}\NormalTok{, }
                        \StringTok{"chartreuse"}\NormalTok{, }\StringTok{"darkgoldenrod1"}\NormalTok{, }\StringTok{"cadetblue"}\NormalTok{,}\StringTok{"purple"}\NormalTok{, }
                        \StringTok{"firebrick1"}\NormalTok{, }\StringTok{"deepskyblue"}\NormalTok{, }\StringTok{"gold"}\NormalTok{, }\StringTok{"violetred4"}\NormalTok{, }
                        \StringTok{"deeppink"}\NormalTok{, }\StringTok{"plum2"}\NormalTok{, }\StringTok{"blue"}\NormalTok{ )}
\KeywordTok{names}\NormalTok{(color_palette_drug) <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(drug_annotation}\OperatorTok{$}\NormalTok{Drug)}
  
\CommentTok{#create vector containing a color name for each sample according to drug}
\NormalTok{color_vector_drug <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(annotation), }\ControlFlowTok{function}\NormalTok{(x)\{}
  \KeywordTok{unname}\NormalTok{(color_palette_drug[annotation[x, }\DecValTok{1}\NormalTok{]]) }\CommentTok{#first column of annotation contains drug}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Coloring according to cancertype (color\_vector\_cancertype)
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#define a color palette with 9 chosen colors}
\NormalTok{color_palette_cancertype <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"aquamarine"}\NormalTok{, }\StringTok{"brown"}\NormalTok{, }\StringTok{"forestgreen"}\NormalTok{, }\StringTok{"chartreuse"}\NormalTok{, }
                              \StringTok{"darkgoldenrod1"}\NormalTok{, }\StringTok{"cadetblue"}\NormalTok{,}\StringTok{"purple"}\NormalTok{, }
                              \StringTok{"firebrick1"}\NormalTok{, }\StringTok{"deepskyblue"}\NormalTok{)}

\KeywordTok{names}\NormalTok{(color_palette_cancertype) <-}\StringTok{ }\KeywordTok{levels}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cancer_type)}

\CommentTok{#create vector containing a color name for each sample according to cancertype}
\NormalTok{color_vector_cancertype <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(annotation), }\ControlFlowTok{function}\NormalTok{(x)\{}
  \KeywordTok{unname}\NormalTok{(color_palette_cancertype[annotation[x, }\DecValTok{3}\NormalTok{]]) }\CommentTok{#3rd columns of annotation contains cancertype }
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\hypertarget{density-plot}{%
\subsubsection{Density plot}\label{density-plot}}

To show the distribution of all gene expression values, a density plot
was drawn. The black line contains all values measured for control
samples (untreated). In red the distribution of the gene expressiion of
all samples treated with 15 drugs is shown.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\KeywordTok{density}\NormalTok{(NCI_TPW_gep_untreated), }
     \StringTok{"Density plot of gene expression"}\NormalTok{, }
     \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{)}
\KeywordTok{lines}\NormalTok{(}\KeywordTok{density}\NormalTok{(NCI_TPW_gep_treated), }\DataTypeTok{col =} \StringTok{"red"}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend =} \KeywordTok{c}\NormalTok{(}\StringTok{"untreated"}\NormalTok{, }\StringTok{"treated"}\NormalTok{), }
       \DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{, }\StringTok{"red"}\NormalTok{), }
       \DataTypeTok{pch =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-11-1} \end{center}

As expected, there can be hardly seen any difference between both
curves. One reason for that is that the gene expression of most of the
13299 genes did not change due to the drug.

\hypertarget{boxplot}{%
\subsubsection{Boxplot}\label{boxplot}}

In a next step the gene expression profile of each untreated sample was
visualized in a boxplot to look, whether the complete expression
profiles look the same over all samples or whether normalization is
needed.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#xaxt = "n": removes labels on x-axis}
\CommentTok{#title() used to move xlab nearer to the axis}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{7.5}\NormalTok{), }\DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{)}
\KeywordTok{boxplot}\NormalTok{(NCI_TPW_gep_untreated, }
        \DataTypeTok{xaxt =} \StringTok{"n"}\NormalTok{, }
        \DataTypeTok{ylab =} \StringTok{"Gene expression profile"}\NormalTok{, }
        \DataTypeTok{vertical =}\NormalTok{  T, }
        \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{,}
        \DataTypeTok{main =} \StringTok{"Gene expression profile of untreated NCI60 celllines"}\NormalTok{)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab =} \StringTok{"Samples"}\NormalTok{, }\DataTypeTok{line =} \FloatTok{1.0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-12-1} \end{center}

In the boxplot sudden differences occuring with a regular pattern can be
observed. An explanation for that could be that the gene expression of
the samples was measured at different points of time or at different
laboratories. This raised the question, whether these batches match with
the 15 drugs these control measurements of untreated expressions were
made. Therefor, the boxes were colored according to the drug the control
was used for.

\textbf{Color plot according to drugs}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{7.5}\NormalTok{), }\DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{)}
\KeywordTok{boxplot}\NormalTok{(NCI_TPW_gep_untreated, }
        \DataTypeTok{xaxt =} \StringTok{"n"}\NormalTok{, }
        \DataTypeTok{ylab =} \StringTok{"Gene expression profile"}\NormalTok{, }
        \DataTypeTok{vertical =}\NormalTok{  T, }
        \DataTypeTok{main =} \StringTok{"Gene expression profile of untreated NCI60 celllines"}\NormalTok{, }
        \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{,}
        \DataTypeTok{boxcol =}\NormalTok{ color_vector_drug)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab =} \StringTok{"Samples"}\NormalTok{, }\DataTypeTok{line =} \FloatTok{1.0}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_drug), }
       \DataTypeTok{col =}\NormalTok{ color_palette_drug,}
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.22}\NormalTok{, }\DecValTok{0}\NormalTok{),}
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-13-1} \end{center}

Since the batches exactly match the different drugs for which the
untreated expression was determined, a \textbf{normalization} is
necessary if the values over the various drugs should be comparable.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#each sample should have mean 0 and sd 1}
\NormalTok{untreated_normalized <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(NCI_TPW_gep_untreated, }\DecValTok{2}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  (x }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)) }\OperatorTok{/}\StringTok{ }\KeywordTok{sd}\NormalTok{(x)}
\NormalTok{\})}
\NormalTok{treated_normalized <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(NCI_TPW_gep_treated, }\DecValTok{2}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  (x }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(x)) }\OperatorTok{/}\StringTok{ }\KeywordTok{sd}\NormalTok{(x)}
\NormalTok{\})}

\NormalTok{FC_normalized <-}\StringTok{ }\NormalTok{treated_normalized }\OperatorTok{-}\StringTok{ }\NormalTok{untreated_normalized}

\CommentTok{#boxplot of normalized untreated values}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{7.5}\NormalTok{), }\DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{)}
\KeywordTok{boxplot}\NormalTok{(untreated_normalized, }
        \DataTypeTok{xaxt =} \StringTok{"n"}\NormalTok{, }
        \DataTypeTok{ylab =} \StringTok{"Gene expression profile"}\NormalTok{, }
        \DataTypeTok{vertical =}\NormalTok{  T, }
        \DataTypeTok{main =} \StringTok{"Normalized gene expression profile of untreated NCI60 celllines"}\NormalTok{,}
        \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{, }
        \DataTypeTok{boxcol =}\NormalTok{ color_vector_drug)}
\KeywordTok{title}\NormalTok{(}\DataTypeTok{xlab =} \StringTok{"Samples"}\NormalTok{, }\DataTypeTok{line =} \FloatTok{1.0}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{,}
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_drug), }
       \DataTypeTok{col =}\NormalTok{ color_palette_drug, }
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{,}
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.22}\NormalTok{, }\DecValTok{0}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-14-1} \end{center}

\hypertarget{pca}{%
\subsubsection{PCA}\label{pca}}

A principal component analysis is used for dimensionality reduction.
With these technique it is possible to depict most of the variance
observed in the gene expression changes due to drug treatment
(foldchange) over all samples. The points were colored firstly according
to drug and secondly according to cancertype to see whether there are
clusters corresponding to drug treatment or cancertype.

\textbf{Coloring according to drug}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca <-}\StringTok{ }\KeywordTok{prcomp}\NormalTok{(FC_normalized)}

\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\FloatTok{7.5}\NormalTok{), }\DataTypeTok{mfrow =} \KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{))}

\CommentTok{#PC1 and PC2}
\KeywordTok{plot}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{1}\NormalTok{], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{2}\NormalTok{], }
     \DataTypeTok{col =}\NormalTok{ color_vector_drug, }
     \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"PC1"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"PC2"}\NormalTok{)}
\CommentTok{#create legend on the right side}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_drug), }
       \DataTypeTok{col =}\NormalTok{ color_palette_drug, }
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
       \DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{,}
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.22}\NormalTok{, }\FloatTok{0.7}\NormalTok{))}
\CommentTok{#Title: mtext = margin text, side = 3 (upside)}
\KeywordTok{mtext}\NormalTok{(}\StringTok{"PCA of FC colored according to drug"}\NormalTok{, }
      \DataTypeTok{side =} \DecValTok{3}\NormalTok{, }
      \DataTypeTok{line =} \FloatTok{-2.5}\NormalTok{,}
      \DataTypeTok{cex =} \FloatTok{1.2}\NormalTok{,}
      \DataTypeTok{font =} \DecValTok{2}\NormalTok{, }\CommentTok{#bold}
      \DataTypeTok{outer =} \OtherTok{TRUE}\NormalTok{)}

\CommentTok{#PC2 and PC3}
\KeywordTok{plot}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{1}\NormalTok{], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{3}\NormalTok{], }
     \DataTypeTok{col =}\NormalTok{ color_vector_drug, }
     \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"PC1"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"PC3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-15-1} \end{center}

In the PCA plot it can be seen that the celllines treated with the same
drug accumulate in certain areas.

\textbf{Coloring according to cancertype}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{), }\DataTypeTok{mfrow =} \KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\CommentTok{#PC1 and PC2}
\KeywordTok{plot}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{1}\NormalTok{], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{2}\NormalTok{], }
     \DataTypeTok{col =}\NormalTok{ color_vector_cancertype, }
     \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"PC1"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"PC2"}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{,}
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_cancertype), }
       \DataTypeTok{col =}\NormalTok{ color_palette_cancertype, }
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
       \DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{,}
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.19}\NormalTok{, }\FloatTok{0.9}\NormalTok{))}
\CommentTok{#PC2 and PC3}
\KeywordTok{plot}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{2}\NormalTok{], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{3}\NormalTok{], }
     \DataTypeTok{col =}\NormalTok{ color_vector_cancertype, }
     \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"PC2"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"PC3"}\NormalTok{)}

\KeywordTok{mtext}\NormalTok{(}\StringTok{"PCA of FC colored according to cancertype"}\NormalTok{, }
      \DataTypeTok{side =} \DecValTok{3}\NormalTok{, }
      \DataTypeTok{line =} \FloatTok{-2.5}\NormalTok{,}
      \DataTypeTok{cex =} \FloatTok{1.2}\NormalTok{,}
      \DataTypeTok{font =} \DecValTok{2}\NormalTok{, }\CommentTok{#bold}
      \DataTypeTok{outer =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-16-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rm}\NormalTok{(pca)}
\end{Highlighting}
\end{Shaded}

The colors showing which cancertype a cellline belongs to seem rather
random distributed in the PCA plot. No clustering between the celllines
beeing part of the same cancertype can be observed.

\hypertarget{most-regulated-genes}{%
\subsubsection{Most regulated genes}\label{most-regulated-genes}}

\textbf{Barplot} to find genes, which were mostly regulated by all
cancer treatments

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#calculating the mean FC over positive FC values}
\NormalTok{mean_FC_abs <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(}\KeywordTok{abs}\NormalTok{(fold_changes), }\DecValTok{1}\NormalTok{, mean)}
\NormalTok{mean_FC_abs <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(mean_FC_abs, }\DataTypeTok{decreasing =} \OtherTok{TRUE}\NormalTok{)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{oma =} \KeywordTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\KeywordTok{barplot}\NormalTok{(mean_FC_abs[}\DecValTok{1}\OperatorTok{:}\DecValTok{20}\NormalTok{], }
        \DataTypeTok{main =} \StringTok{"Genes with highest mean in absolute FC"}\NormalTok{,}
        \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{,}
        \DataTypeTok{ylab =} \StringTok{"mean FC"}\NormalTok{, }
        \DataTypeTok{las =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-17-1} \end{center}

\textbf{Boxplot} of genes with highest mean FC

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#FC_samples_with_highest_mean_FC contains the gene expression of the 20 biomarkers (20 columns) of all samples(819 rows) }
\NormalTok{FC_samples_with_highest_mean_FC <-}\StringTok{ }\KeywordTok{data.matrix}\NormalTok{(}\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(}\KeywordTok{names}\NormalTok{(mean_FC_abs)[}\DecValTok{1}\OperatorTok{:}\DecValTok{20}\NormalTok{], }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  fold_changes[}\KeywordTok{which}\NormalTok{(x }\OperatorTok{==}\StringTok{ }\KeywordTok{rownames}\NormalTok{(fold_changes)),]}
\NormalTok{\})))}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\KeywordTok{boxplot}\NormalTok{(FC_samples_with_highest_mean_FC, }
      \DataTypeTok{ylab =} \StringTok{"foldchange"}\NormalTok{, }
      \DataTypeTok{main =} \StringTok{"Boxplot of foldchange of the genes with highest mean FC"}\NormalTok{, }
      \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{,}
      \DataTypeTok{las =} \DecValTok{2}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-18-1} \end{center}

\hypertarget{specific-analysis-erlotinib}{%
\subsection{\texorpdfstring{\textbf{Specific analysis: Erlotinib
}}{Specific analysis: Erlotinib }}\label{specific-analysis-erlotinib}}

\hypertarget{milestone-find-most-affected-cell-lines-and-genes}{%
\subsection{2. Milestone: find most affected cell lines and
genes}\label{milestone-find-most-affected-cell-lines-and-genes}}

\hypertarget{data-preparation}{%
\subsubsection{Data preparation}\label{data-preparation}}

\textbf{Erlotinib treated} cell lines are selected and the matrix of the
foldchange is normalized

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#new matrix only with samples/columns treated with erlotinib  (e=erlotinib)}
\NormalTok{e_treated <-}\StringTok{ }\NormalTok{NCI_TPW_gep_treated[,}\KeywordTok{grep}\NormalTok{ (}\StringTok{"erlotinib"}\NormalTok{, }\KeywordTok{colnames}\NormalTok{(NCI_TPW_gep_treated))]}
\NormalTok{e_untreated <-}\StringTok{ }\NormalTok{NCI_TPW_gep_untreated[,}\KeywordTok{grep}\NormalTok{ (}\StringTok{"erlotinib"}\NormalTok{, }\KeywordTok{colnames}\NormalTok{(NCI_TPW_gep_treated))]}

\CommentTok{#z-Transformation of e_treated/e_untreated to get mean=0 and sd=1, equivalent to scale(e_treated, scale=TRUE)}
\CommentTok{#e_treated <- apply(e_treated, 2, function(x)\{}
  \CommentTok{#(x - mean(x)) / sd(x)}
\CommentTok{#\})}
\CommentTok{#e_untreated <- apply(e_untreated, 2, function(x)\{}
  \CommentTok{#(x - mean(x)) / sd(x)}
\CommentTok{#\})}

\CommentTok{# calculate foldchange by substracting e_untreated from e_treated}
\NormalTok{e_foldchange <-}\StringTok{ }\NormalTok{e_treated }\OperatorTok{-}\StringTok{ }\NormalTok{e_untreated}

\CommentTok{#colnames of e_foldchange with cellline instead of complete sample name}
\NormalTok{cellline <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(e_foldchange), }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  annotation[x,}\StringTok{"Cellline"}\NormalTok{]}
\NormalTok{  \}) }
\KeywordTok{colnames}\NormalTok{(e_foldchange) <-}\StringTok{ }\NormalTok{cellline}
\end{Highlighting}
\end{Shaded}

\hypertarget{most-regulated-cell-lines}{%
\subsubsection{\texorpdfstring{\textbf{Most regulated cell
lines}}{Most regulated cell lines}}\label{most-regulated-cell-lines}}

\hypertarget{table-of-15-cell-lines}{%
\subsubsection{Table of 15 cell lines}\label{table-of-15-cell-lines}}

Cell lines, which showed the highest variance over all genes were
selected

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#select 15 cell lines with highest variance (greater than 75% quantile, sorted by decreasing value)}
\NormalTok{var_cell_line <-}\StringTok{ }\KeywordTok{apply}\NormalTok{(e_foldchange, }\DecValTok{2}\NormalTok{, var)}
\NormalTok{cell_line_var_greater_75quantile <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(var_cell_line [}\KeywordTok{which}\NormalTok{ (}\KeywordTok{abs}\NormalTok{(var_cell_line) }\OperatorTok{>}\StringTok{ }\KeywordTok{quantile}\NormalTok{(}\KeywordTok{abs}\NormalTok{(var_cell_line), }\FloatTok{0.75}\NormalTok{))], }\DataTypeTok{decreasing =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{cell_line_var_greater_75quantile <-}\StringTok{ }\KeywordTok{round}\NormalTok{(cell_line_var_greater_75quantile, }\DataTypeTok{digits=}\DecValTok{5}\NormalTok{)}

\CommentTok{#add column with cell line for top15 celllines}
\NormalTok{celllines_top15 <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{names}\NormalTok{(cell_line_var_greater_75quantile))}

\CommentTok{#add column with cancertype for top15 celllines}
\NormalTok{annotation_cancertype <-}\StringTok{ }\NormalTok{annotation[,}\StringTok{"Cancertype"}\NormalTok{]}
\KeywordTok{names}\NormalTok{(annotation_cancertype) <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(e_foldchange)}
\NormalTok{cancertypes_top15 <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{names}\NormalTok{(cell_line_var_greater_75quantile), }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  annotation_cancertype[}\KeywordTok{which}\NormalTok{(x }\OperatorTok{==}\StringTok{ }\KeywordTok{names}\NormalTok{(annotation_cancertype))]}
\NormalTok{\})}
\NormalTok{table_cell_lines_var_top15 <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(celllines_top15), celllines_top15, }
\NormalTok{                                    cell_line_var_greater_75quantile, cancertypes_top15)}

\KeywordTok{colnames}\NormalTok{(table_cell_lines_var_top15) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Rank"}\NormalTok{, }\StringTok{"Cellline"}\NormalTok{, }\StringTok{"Variance"}\NormalTok{, }\StringTok{"Cancertype"}\NormalTok{)}
\KeywordTok{rownames}\NormalTok{(table_cell_lines_var_top15) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{nrow}\NormalTok{(celllines_top15))}

\KeywordTok{library}\NormalTok{(formattable)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning: package 'formattable' was built under R version 3.5.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{formattable}\NormalTok{(table_cell_lines_var_top15)}
\end{Highlighting}
\end{Shaded}

Rank

Cellline

Variance

Cancertype

1

NCI-H322M

0.45385

Renal

2

ACHN

0.34745

Renal

3

IGR-OV1

0.33955

Leukemia

4

SK-OV-3

0.29909

NSCL

5

CAKI-1

0.20350

Prostate

6

OVCAR-3

0.20219

Renal

7

HL-60

0.19209

Melanoma

8

CCRF-CEM

0.18592

Colon

9

MDA-MB-468

0.17965

CNS

10

SN12C

0.16687

Colon

11

NCI-H522

0.16137

Breast

12

K-562

0.14258

NSCL

13

HCT-15

0.13979

Colon

14

DU-145

0.13966

NSCL

15

SR

0.13955

NSCL

\hypertarget{pca-1}{%
\subsubsection{PCA}\label{pca-1}}

PCA is performed to find cell lines, which differ most from the other
cell lines

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#PCA with transformed matrix (each point represents a sample):}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar=} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{))}
\NormalTok{pca <-}\StringTok{ }\KeywordTok{prcomp}\NormalTok{(e_foldchange)}
\KeywordTok{plot}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{1}\NormalTok{], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[,}\DecValTok{2}\NormalTok{], }
     \DataTypeTok{col=}\NormalTok{color_vector_cancertype, }
     \DataTypeTok{pch=}\DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"PC1"}\NormalTok{, }
     \DataTypeTok{ylab=}\StringTok{"PC2"}\NormalTok{, }
     \DataTypeTok{main =} \StringTok{"PCA of cell lines"}\NormalTok{,}
     \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_cancertype), }
       \DataTypeTok{col =}\NormalTok{ color_palette_cancertype, }
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
       \DataTypeTok{xpd =} \OtherTok{TRUE}\NormalTok{, }
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.18}\NormalTok{, }\DecValTok{0}\NormalTok{))}
\CommentTok{#label points}
\NormalTok{labeled_celllines_PCA <-}\StringTok{ }\KeywordTok{names}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[ , }\DecValTok{1}\NormalTok{])[pca}\OperatorTok{$}\NormalTok{rotation[ , }\DecValTok{1}\NormalTok{] }\OperatorTok{>}\StringTok{ }\FloatTok{0.14}\NormalTok{]}
\KeywordTok{text}\NormalTok{(pca}\OperatorTok{$}\NormalTok{rotation[ ,}\DecValTok{1}\NormalTok{][labeled_celllines_PCA], }
\NormalTok{     pca}\OperatorTok{$}\NormalTok{rotation[ ,}\DecValTok{2}\NormalTok{][labeled_celllines_PCA], }
\NormalTok{     labeled_celllines_PCA,}
     \DataTypeTok{pos =} \DecValTok{2}\NormalTok{,}
     \DataTypeTok{cex =} \FloatTok{0.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-21-1} \end{center}

\hypertarget{most-regulated-genes-1}{%
\subsubsection{\texorpdfstring{\textbf{Most regulated
genes}}{Most regulated genes}}\label{most-regulated-genes-1}}

\hypertarget{ma-plot}{%
\subsubsection{MA-Plot}\label{ma-plot}}

Draw an MA plot to compare the fold change to the mean expression of all
genes

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#mean of gene expression of each gene over all cell lines}
\NormalTok{e_foldchange_mean_over_cell_lines <-}\StringTok{ }\KeywordTok{rowMeans}\NormalTok{(e_foldchange) }\CommentTok{#equal to e_treated_mean_over_cell_lines - e_untreated_mean_over_cell_line}

\CommentTok{#determine the p-value for a paired two-sample t-test }
\NormalTok{p_values <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(e_treated), }\ControlFlowTok{function}\NormalTok{(x) \{}
  \KeywordTok{t.test}\NormalTok{(e_treated[x,], e_untreated[x,],}\DataTypeTok{paired=}\NormalTok{ T)}\OperatorTok{$}\NormalTok{p.value\}) }\CommentTok{# perform t-test and save p-values of each gene in p_vales-vector}
\NormalTok{FDR_values <-}\StringTok{ }\KeywordTok{p.adjust}\NormalTok{(p_values, }\DataTypeTok{method =} \StringTok{"BH"}\NormalTok{, }\DataTypeTok{n =} \KeywordTok{length}\NormalTok{(p_values))}\CommentTok{#calculate FDR with benjamini-hochberg (BH)}


\CommentTok{#table of results }
\NormalTok{statistics_values <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(e_foldchange_mean_over_cell_lines, FDR_values)}

\CommentTok{#install package and load ggplot2 and ggrepel}
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(ggrepel)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'ggrepel' was built under R version 3.5.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#create matrices with the variables M and A of a MA-plot}
\NormalTok{M <-}\StringTok{ }\NormalTok{e_foldchange }\CommentTok{# M= log2(treated) - log2 (untreated)}
\NormalTok{A <-}\StringTok{ }\DecValTok{1}\OperatorTok{/}\DecValTok{2}\OperatorTok{*}\NormalTok{(e_treated}\OperatorTok{+}\StringTok{ }\NormalTok{e_untreated) }\CommentTok{# average log2-expression value A = 1/2 (log2(treated)+log2(untreated))}
\NormalTok{MA <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(}\StringTok{"M"}\NormalTok{=}\StringTok{ }\KeywordTok{rowMeans}\NormalTok{(M), }\StringTok{"A"}\NormalTok{ =}\StringTok{ }\KeywordTok{rowMeans}\NormalTok{(A), FDR_values)}
\KeywordTok{rm}\NormalTok{(M, A)}
\NormalTok{MA <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(MA)}
\NormalTok{MA}\OperatorTok{$}\NormalTok{Significant <-}\StringTok{ }\KeywordTok{ifelse}\NormalTok{(MA}\OperatorTok{$}\NormalTok{FDR_values }\OperatorTok{<}\StringTok{ }\FloatTok{0.05}\NormalTok{, }\StringTok{"FDR < 0.05"}\NormalTok{, }\StringTok{"Not Sig"}\NormalTok{)}

\CommentTok{#matrix with important genes of MA plot }
\NormalTok{MA_labeled <-}\StringTok{ }\NormalTok{MA[}\KeywordTok{which}\NormalTok{(MA[ , }\StringTok{"M"}\NormalTok{] }\OperatorTok{>}\StringTok{ }\DecValTok{1}\NormalTok{) , ]}

\CommentTok{#MA plot labeled with important genes of MA plot}
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ MA)}\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ A, }\DataTypeTok{y =}\NormalTok{ M, }\DataTypeTok{color =}\NormalTok{ Significant)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"mean expression"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"log fold change"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"MA plot of all genes"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_text}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ MA_labeled, }\KeywordTok{aes}\NormalTok{(A, M, }\DataTypeTok{label =} \KeywordTok{rownames}\NormalTok{(MA_labeled)), }\DataTypeTok{hjust =} \DecValTok{0}\NormalTok{, }\DataTypeTok{nudge_x =} \FloatTok{0.1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{13}\NormalTok{, }\DataTypeTok{face =} \StringTok{"bold"}\NormalTok{, }\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\CommentTok{# change the size and face (bold) of the title and center it (hjust=0.5)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-22-1} \end{center}

\hypertarget{volcano-plot}{%
\subsubsection{Volcano plot}\label{volcano-plot}}

Create volcano plot to find the genes with the highest fold change and
highest significance

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#coloring with package enhanced volcano}
\CommentTok{#install package EnhancedVolcano (needs ggplot2, ggrepel)}
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(ggrepel)}
\KeywordTok{library}\NormalTok{(EnhancedVolcano)}

\KeywordTok{EnhancedVolcano}\NormalTok{(statistics_values, }
                \DataTypeTok{lab =} \KeywordTok{rownames}\NormalTok{(statistics_values),}
                \DataTypeTok{x =} \StringTok{"e_foldchange_mean_over_cell_lines"}\NormalTok{, }
                \CommentTok{#colname of FC values in this table (statistics_values)}
                \DataTypeTok{y =} \StringTok{"FDR_values"}\NormalTok{, }\CommentTok{#colname of FDR (statistics_values)}
                \DataTypeTok{title =} \StringTok{"Volcano plot of all genes"}\NormalTok{,}
                \DataTypeTok{titleLabSize =} \DecValTok{13}\NormalTok{,}
                \DataTypeTok{pCutoff =} \FloatTok{10e-10}\NormalTok{, }\CommentTok{#threshold for coloring significant ones}
                \DataTypeTok{FCcutoff =} \FloatTok{0.5}\NormalTok{, }\CommentTok{#threshold for coloring high FC}
                \DataTypeTok{transcriptPointSize =} \DecValTok{2}\NormalTok{,}
                \DataTypeTok{transcriptLabSize =} \DecValTok{3}\NormalTok{,}
                \DataTypeTok{legendPosition =} \StringTok{"right"}\NormalTok{,}
                \DataTypeTok{legendLabSize=} \DecValTok{10}\NormalTok{,}
                \DataTypeTok{axisLabSize =} \DecValTok{10} 
                \CommentTok{# subtitle = "")  remove subtitle generated by Bioconductor}
\NormalTok{                 )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-23-1} \end{center}

\hypertarget{density-plot-1}{%
\subsubsection{Density plot}\label{density-plot-1}}

Draw a density plot only with biomarkers identified by volcano plot

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#save the "red" genes seen in the volcano plot in a vector for further analysis}
\NormalTok{biomarkers_volcano <-}\StringTok{ }\KeywordTok{rownames}\NormalTok{(statistics_values)[}\KeywordTok{which}\NormalTok{(}\KeywordTok{abs}\NormalTok{(statistics_values[, }\DecValTok{1}\NormalTok{]) }\OperatorTok{>}\StringTok{ }\FloatTok{0.5} 
                                                   \OperatorTok{&}\StringTok{ }\NormalTok{statistics_values[, }\DecValTok{2}\NormalTok{] }\OperatorTok{<}\StringTok{ }\FloatTok{10e-10}\NormalTok{)]}
\NormalTok{biomarkers <-}\StringTok{ }\KeywordTok{rownames}\NormalTok{(statistics_values)[}\KeywordTok{which}\NormalTok{(}\KeywordTok{abs}\NormalTok{(statistics_values[, }\DecValTok{1}\NormalTok{]) }\OperatorTok{>}\StringTok{ }\FloatTok{0.5}\NormalTok{)]}

\CommentTok{#Density plot with these genes (untreated vs. treated)}
\KeywordTok{plot}\NormalTok{(}\KeywordTok{density}\NormalTok{(e_treated[biomarkers, ]), }\StringTok{"Density plot of gene expression"}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{1.2}\NormalTok{, }\DataTypeTok{col =} \StringTok{"red"}\NormalTok{)}

\KeywordTok{lines}\NormalTok{(}\KeywordTok{density}\NormalTok{(e_untreated[biomarkers, ]), }\DataTypeTok{col =} \StringTok{"black"}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }\DataTypeTok{legend =} \KeywordTok{c}\NormalTok{(}\StringTok{"untreated"}\NormalTok{, }\StringTok{"treated"}\NormalTok{), }\DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{, }\StringTok{"red"}\NormalTok{), }\DataTypeTok{pch =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-24-1} \end{center}

\hypertarget{venn-diagram}{%
\subsubsection{Venn Diagram}\label{venn-diagram}}

Venn Diagramm is drawn to compare the most regulated genes by volcano
plot and MA plot

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Venn Diagram with biomarkers of volcano plot and MA plot}
\KeywordTok{library}\NormalTok{(VennDiagram)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{oma =} \KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\NormalTok{biomarkers_MA_vector <-}\StringTok{ }\KeywordTok{rownames}\NormalTok{(MA_labeled)}
\NormalTok{venn.plot <-}\StringTok{ }\KeywordTok{venn.diagram}\NormalTok{(}
  \DataTypeTok{x =} \KeywordTok{list}\NormalTok{(}
    \StringTok{"Volcano Plot"}\NormalTok{ =}\StringTok{ }\NormalTok{biomarkers_volcano,}
    \StringTok{"MA Plot"}\NormalTok{ =}\StringTok{ }\NormalTok{biomarkers_MA_vector}
\NormalTok{    ),}
  \DataTypeTok{filename =} \OtherTok{NULL}\NormalTok{, }
  \DataTypeTok{fill =} \KeywordTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"red"}\NormalTok{), }
  \DataTypeTok{main =} \StringTok{"Venn Diagramm of most regulated genes"}\NormalTok{, }
  \DataTypeTok{main.fontface =} \DecValTok{2}\NormalTok{,}
  \DataTypeTok{main.cex =} \FloatTok{1.2}\NormalTok{,}
  \DataTypeTok{main.fontfamily =} \StringTok{"sans"}\NormalTok{, }\CommentTok{# font type of title is Arial }
  \DataTypeTok{cat.fontfamily =} \StringTok{"sans"}\NormalTok{,}
  \DataTypeTok{cat.cex =} \FloatTok{0.9}\NormalTok{,}
  \CommentTok{#cat.dist = 0.1, # distance between category and edge of circle}
  \DataTypeTok{fontfamily =} \StringTok{"sans"}\NormalTok{,}
  \DataTypeTok{cat.pos =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{));}
\KeywordTok{grid.draw}\NormalTok{(venn.plot);}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-25-1} \end{center}

\hypertarget{boxplot-1}{%
\subsubsection{Boxplot}\label{boxplot-1}}

Draw a boxplot of the \textbf{foldchange} of biomarkers

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# create a matrix foldchange_biomarkers_volcano, with the foldchange only of the biomarkers}
\NormalTok{foldchange_biomarkers <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(biomarkers_volcano, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  e_foldchange[x, ]}
\NormalTok{\})}
\KeywordTok{boxplot}\NormalTok{(foldchange_biomarkers, }\DataTypeTok{ylab=} \StringTok{"foldchange"}\NormalTok{, }
        \DataTypeTok{main=} \StringTok{"Boxplot of foldchange of the volcano biomarkers"}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{1.2}\NormalTok{, }\DataTypeTok{las=}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-26-1} \end{center}

Draw a boxplot of the \textbf{untreated vs.~treated gene expression} of
biomarkers

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# create a matrix e_treated_biomarkers_volcano/ e_untreated_biomarkers_volcano, with the gene expression only of the biomarkers_volcano}
\NormalTok{e_treated_biomarkers_volcano <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(biomarkers_volcano, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  e_treated[x, ]}
\NormalTok{\})}
\NormalTok{e_untreated_biomarkers_volcano <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(biomarkers_volcano, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  e_untreated[x, ]}
\NormalTok{\}) }
\KeywordTok{colnames}\NormalTok{(e_treated_biomarkers_volcano) <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(e_treated_biomarkers_volcano),}\StringTok{"Treated"}\NormalTok{,}
                                          \DataTypeTok{sep =} \StringTok{"_"}\NormalTok{) }\CommentTok{#add treated to colnames}

\CommentTok{# create a matrix, which contains gene expression of untreated and treated and sort it after colnames}
\NormalTok{e_treated_untreated_biomarkers_volcano <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{ (e_treated_biomarkers_volcano, e_untreated_biomarkers_volcano)}
\NormalTok{e_treated_untreated_biomarkers_volcano <-}\StringTok{ }\NormalTok{e_treated_untreated_biomarkers_volcano[,}\KeywordTok{order}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(e_treated_untreated_biomarkers_volcano))]}

\CommentTok{# create a color vector, where untreated samples are green and treated ones are red}
\NormalTok{color_boxplot_e_treated_untreated <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{colnames}\NormalTok{(e_treated_untreated_biomarkers_volcano), }\ControlFlowTok{function}\NormalTok{(x) \{}
  \KeywordTok{ifelse}\NormalTok{(x }\OperatorTok{%in%}\StringTok{ }\KeywordTok{grep}\NormalTok{ (}\StringTok{"Treated"}\NormalTok{,}\KeywordTok{colnames}\NormalTok{(e_treated_untreated_biomarkers_volcano), }\DataTypeTok{value =} \OtherTok{TRUE}\NormalTok{),}
         \StringTok{"red"}\NormalTok{, }\StringTok{"green"}\NormalTok{)\})}

\CommentTok{# boxplot, where treated and untreated are right next to each other}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\KeywordTok{boxplot}\NormalTok{(e_treated_untreated_biomarkers_volcano, }
        \DataTypeTok{ylab =} \StringTok{"gene expression (log2)"}\NormalTok{, }
        \DataTypeTok{main=} \StringTok{"Boxplot of gene expression of the volcano biomarkers"}\NormalTok{, }
        \DataTypeTok{ceex =} \FloatTok{1.2}\NormalTok{, }
        \DataTypeTok{las =} \DecValTok{2}\NormalTok{, }
        \DataTypeTok{col =}\NormalTok{ color_boxplot_e_treated_untreated)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-27-1} \end{center}

\hypertarget{milestone---does-the-fold-change-of-specific-genes-correlate-with-cell-growth-inhibition}{%
\subsection{3. Milestone - Does the fold change of specific genes
correlate with cell growth
inhibition?}\label{milestone---does-the-fold-change-of-specific-genes-correlate-with-cell-growth-inhibition}}

\hypertarget{data-prepatation}{%
\subsubsection{Data prepatation}\label{data-prepatation}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# vector which only includes celllines which were used in e_foldchange_normalized}
\NormalTok{NegLogGI50_}\DecValTok{59}\NormalTok{_celllines <-}\StringTok{ }\NormalTok{NegLogGI50 [}\StringTok{"erlotinib"}\NormalTok{, }\OperatorTok{-}\KeywordTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{,}\DecValTok{29}\NormalTok{)]}
\NormalTok{LogGI50_}\DecValTok{59}\NormalTok{_celllines <-}\StringTok{ }\NormalTok{NegLogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{*}\StringTok{ }\NormalTok{(}\OperatorTok{-}\DecValTok{1}\NormalTok{)}


\CommentTok{#colnames of e_untreated with cellline instead of complete sample name}
\KeywordTok{colnames}\NormalTok{(e_untreated) <-}\StringTok{ }\NormalTok{cellline}
\end{Highlighting}
\end{Shaded}

\hypertarget{scatter-plot-relation-between-gi50-and-egr1-expression}{%
\subsubsection{Scatter plot: Relation between GI50 and EGR1
expression}\label{scatter-plot-relation-between-gi50-and-egr1-expression}}

Draw a scatterplot which include the GI50 values against the EGR1
expression revative to the untreated control. EGR1 is a transcriptional
factor and is assocciated with the activiation of tumor suppressor genes
like p53/TP53 and TGFB1, and plays an important role in the regulation
of growth factor responses.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Import picture shown in the Supplementary after 6h}
\NormalTok{url <-}\StringTok{ "https://raw.githubusercontent.com/datascience-mobi/project-02-group-04/master/Project%20proposal/EGR1%20expression.PNG"}
\KeywordTok{include_graphics}\NormalTok{(url)}
\end{Highlighting}
\end{Shaded}

\textbackslash begin\{center\}\textbackslash includegraphics\{\url{https://raw.githubusercontent.com/datascience-mobi/project-02-group-04/master/Project\%20proposal/EGR1\%20expression}\}
\textbackslash end\{center\}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Coloring according to cancertype}
\NormalTok{e_color_cancertype <-}\StringTok{ }\NormalTok{color_vector_cancertype[}\KeywordTok{grep}\NormalTok{(}\StringTok{"erlotinib"}\NormalTok{, }\KeywordTok{names}\NormalTok{(color_vector_cancertype), }\DataTypeTok{value =} \OtherTok{TRUE}\NormalTok{)]}

\CommentTok{#Scatter plot}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{), }\DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines, e_foldchange [}\StringTok{"EGR1"}\NormalTok{,], }
     \DataTypeTok{col =}\NormalTok{ e_color_cancertype, }
     \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"logGI50"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"EGR1 Expression (log2, relative to control)"}\NormalTok{,        }
     \DataTypeTok{main =} \StringTok{"Erlotinib 24h"}\NormalTok{, }
     \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{, }
     \DataTypeTok{col.main =} \StringTok{"deepskyblue"}\NormalTok{)}

\KeywordTok{segments}\NormalTok{(}\OperatorTok{-}\FloatTok{7.11}\NormalTok{,}\DecValTok{0}\NormalTok{, }\FloatTok{-3.88}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
       \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_cancertype), }
       \DataTypeTok{col =}\NormalTok{ color_palette_cancertype, }
       \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.32}\NormalTok{, }\DecValTok{0}\NormalTok{),}
       \DataTypeTok{pch =} \DecValTok{19}\NormalTok{)}


\CommentTok{#label only points in the left bottom quarter}
\NormalTok{labeled_celllines <-}\StringTok{ }\KeywordTok{names}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines)[LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{<}\StringTok{ }\OperatorTok{-}\StringTok{ }\DecValTok{6}
                                                        \OperatorTok{&}\StringTok{ }\NormalTok{e_foldchange[}\StringTok{"EGR1"}\NormalTok{, ] }\OperatorTok{<}\StringTok{ }\DecValTok{0} 
                                                 \OperatorTok{|}\StringTok{ }\NormalTok{LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{<}\StringTok{ }\DecValTok{-5} 
                                                        \OperatorTok{&}\StringTok{ }\NormalTok{e_foldchange[}\StringTok{"EGR1"}\NormalTok{, ] }\OperatorTok{<}\StringTok{ }\DecValTok{-3}\NormalTok{]}

\KeywordTok{text}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines[labeled_celllines], e_foldchange [}\StringTok{"EGR1"}\NormalTok{, labeled_celllines], }
     \DataTypeTok{labels =}\NormalTok{ labeled_celllines,}
     \DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{,}
     \DataTypeTok{pos =} \DecValTok{4}\NormalTok{) }\CommentTok{#position of text at the right of the point}

\KeywordTok{mtext}\NormalTok{(}\DataTypeTok{side =} \DecValTok{3}\NormalTok{, }\DataTypeTok{line =} \DecValTok{-1}\NormalTok{, }\DataTypeTok{text =} \StringTok{"r= 0.6792 (***)"}\NormalTok{, }\DataTypeTok{adj =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.01}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/figEGR1 -2} \end{center}

\hypertarget{linear-regression-between-egr1-expression-and-the-gi50-value-after-erlotinib-treatment}{%
\subsubsection{linear regression between EGR1 expression and the GI50
value after erlotinib
treatment}\label{linear-regression-between-egr1-expression-and-the-gi50-value-after-erlotinib-treatment}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{linearMod_EGR1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{~}\StringTok{ }\NormalTok{e_foldchange [}\StringTok{"EGR1"}\NormalTok{,])  }\CommentTok{# build linear regression model on full data}

\KeywordTok{summary}\NormalTok{(linearMod_EGR1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = LogGI50_59_celllines ~ e_foldchange["EGR1", ])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5359 -0.4638  0.1442  0.4233  1.1254 

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            -4.90221    0.09368 -52.330  < 2e-16 ***
e_foldchange["EGR1", ]  0.31639    0.05519   5.733 3.93e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6273 on 57 degrees of freedom
Multiple R-squared:  0.3657,    Adjusted R-squared:  0.3546 
F-statistic: 32.86 on 1 and 57 DF,  p-value: 3.927e-07
\end{verbatim}

Only 25 \% can be described by EGR1- expression, which makes a linear
regression model kind of unfitted.

\hypertarget{her-1-gene-expression-in-the-untreated-celllines-against-gi50-values}{%
\subsubsection{Her 1 gene expression in the untreated celllines against
GI50
values}\label{her-1-gene-expression-in-the-untreated-celllines-against-gi50-values}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{), }\DataTypeTok{xpd =} \StringTok{"TRUE"}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines, e_untreated [}\StringTok{"EGFR"}\NormalTok{,], }
      \DataTypeTok{col =}\NormalTok{ e_color_cancertype, }
      \DataTypeTok{pch =} \DecValTok{19}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{"logGI50"}\NormalTok{, }
     \DataTypeTok{ylab =} \StringTok{"EGFR Expression (untreated)"}\NormalTok{,        }
     \DataTypeTok{main =} \StringTok{"Expression of the epidermal growth factor receptor (Her 1)"}\NormalTok{,}
     \DataTypeTok{cex.main =} \FloatTok{1.2}\NormalTok{)}
\KeywordTok{legend}\NormalTok{(}\StringTok{"topright"}\NormalTok{, }
    \DataTypeTok{legend =} \KeywordTok{names}\NormalTok{(color_palette_cancertype), }
    \DataTypeTok{col =}\NormalTok{ color_palette_cancertype, }
    \DataTypeTok{pch =} \DecValTok{19}\NormalTok{,}
    \DataTypeTok{inset =} \KeywordTok{c}\NormalTok{(}\OperatorTok{-}\FloatTok{0.18}\NormalTok{, }\DecValTok{0}\NormalTok{),}
    \DataTypeTok{xpd =} \OtherTok{TRUE}\NormalTok{)}

\KeywordTok{clip}\NormalTok{(}\OperatorTok{-}\FloatTok{7.13}\NormalTok{, }\FloatTok{-3.88}\NormalTok{,  }\DecValTok{4}\NormalTok{, }\DecValTok{13}\NormalTok{)}
\KeywordTok{abline}\NormalTok{(}\KeywordTok{lm}\NormalTok{ (e_untreated[}\StringTok{"EGFR"}\NormalTok{, ]}\OperatorTok{~}\StringTok{ }\NormalTok{LogGI50_}\DecValTok{59}\NormalTok{_celllines))}

\KeywordTok{text}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines, e_untreated [}\StringTok{"EGFR"}\NormalTok{,], }
     \DataTypeTok{labels  =} \KeywordTok{names}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines),}
     \DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{, }
     \DataTypeTok{pos =} \DecValTok{4}\NormalTok{)}

\NormalTok{labeled_celllines_EGFR <-}\StringTok{ }\KeywordTok{names}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines)[LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{<}\StringTok{ }\OperatorTok{-}\StringTok{ }\FloatTok{5.5}
                                                        \OperatorTok{&}\StringTok{ }\NormalTok{e_untreated [}\StringTok{"EGFR"}\NormalTok{, ] }\OperatorTok{>}\StringTok{ }\DecValTok{8}\NormalTok{]}

\KeywordTok{text}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines[labeled_celllines_EGFR], e_untreated [}\StringTok{"EGFR"}\NormalTok{, labeled_celllines_EGFR], }
     \DataTypeTok{labels =}\NormalTok{ labeled_celllines_EGFR,}
     \DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{,}
     \DataTypeTok{pos =} \DecValTok{3}\NormalTok{)}
\CommentTok{#Funktioniert noch nicht}
\KeywordTok{abline}\NormalTok{(}\KeywordTok{lm}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{~}\StringTok{ }\NormalTok{e_untreated[}\StringTok{"EGFR"}\NormalTok{,]))}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-30-1} \end{center}

\hypertarget{venn-diagramm}{%
\subsubsection{Venn Diagramm}\label{venn-diagramm}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cor_all_genes <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\KeywordTok{rownames}\NormalTok{(e_foldchange), }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  cor_test_one_gene <-}\StringTok{ }\KeywordTok{cor.test}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines, e_foldchange[x,], }\DataTypeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\NormalTok{  cor_test_one_gene}\OperatorTok{$}\NormalTok{estimate}
\NormalTok{\})}
\NormalTok{cor_all_genes_sorted <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(cor_all_genes, }\DataTypeTok{decreasing =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{cor_top_}\DecValTok{500}\NormalTok{_genes <-}\StringTok{ }\NormalTok{cor_all_genes_sorted[}\DecValTok{1}\OperatorTok{:}\DecValTok{500}\NormalTok{]}
\NormalTok{cor_all_genes_sorted[}\DecValTok{500}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## HIRIP3.cor 
##  0.5352803
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cor_biomarkers <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(biomarkers_volcano, }\ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{  cor_test_one_biomarker <-}\StringTok{ }\KeywordTok{cor.test}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines, e_foldchange[x,], }\DataTypeTok{method =} \StringTok{"pearson"}\NormalTok{)}
\NormalTok{  cor_test_one_biomarker}\OperatorTok{$}\NormalTok{estimate}
\NormalTok{\})}
\KeywordTok{library}\NormalTok{(VennDiagram)}
\KeywordTok{par}\NormalTok{(}\DataTypeTok{oma =} \KeywordTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\NormalTok{biomarkers_MA_vector <-}\StringTok{ }\KeywordTok{rownames}\NormalTok{(MA_labeled)}
\NormalTok{venn.plot <-}\StringTok{ }\KeywordTok{venn.diagram}\NormalTok{(}
  \DataTypeTok{x =} \KeywordTok{list}\NormalTok{(}
    \StringTok{"100 genes with highest correlation"}\NormalTok{ =}\StringTok{ }\KeywordTok{names}\NormalTok{(cor_top_}\DecValTok{500}\NormalTok{_genes),}
    \StringTok{"correlation of biomarkers"}\NormalTok{ =}\StringTok{ }\KeywordTok{names}\NormalTok{(cor_biomarkers)}
\NormalTok{    ),}
  \DataTypeTok{filename =} \OtherTok{NULL}\NormalTok{, }
  \DataTypeTok{fill =} \KeywordTok{c}\NormalTok{(}\StringTok{"blue"}\NormalTok{, }\StringTok{"red"}\NormalTok{), }
  \DataTypeTok{main =} \StringTok{"Venn Diagramm of genes with highest GI50-foldchange correlation compared to biomarker"}\NormalTok{, }
  \DataTypeTok{main.fontface =} \DecValTok{2}\NormalTok{,}
  \DataTypeTok{main.cex =} \FloatTok{1.2}\NormalTok{,}
  \DataTypeTok{main.fontfamily =} \StringTok{"sans"}\NormalTok{, }\CommentTok{# font type of title is Arial }
  \DataTypeTok{cat.fontfamily =} \StringTok{"sans"}\NormalTok{,}
  \DataTypeTok{cat.cex =} \FloatTok{0.9}\NormalTok{,}
  \CommentTok{#cat.dist = 0.1, # distance between category and edge of circle}
  \DataTypeTok{fontfamily =} \StringTok{"sans"}\NormalTok{,}
  \DataTypeTok{cat.pos =} \KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{));}
\KeywordTok{grid.draw}\NormalTok{(venn.plot);}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-31-1} \end{center}

\hypertarget{lineare-regression-her-1-expression-against-the-gi50-values}{%
\subsubsection{lineare regression Her 1 expression against the GI50
values}\label{lineare-regression-her-1-expression-against-the-gi50-values}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{linearMod_Her1 <-}\StringTok{ }\KeywordTok{lm}\NormalTok{(LogGI50_}\DecValTok{59}\NormalTok{_celllines }\OperatorTok{~}\StringTok{ }\NormalTok{e_untreated [}\StringTok{"EGFR"}\NormalTok{,])  }\CommentTok{# build linear regression model on full data}
\KeywordTok{summary}\NormalTok{(linearMod_Her1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = LogGI50_59_celllines ~ e_untreated["EGFR", ])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.85461 -0.30720  0.09961  0.47793  1.22004 

Coefficients:
                      Estimate Std. Error t value Pr(>|t|)    
(Intercept)           -4.14018    0.31366 -13.199  < 2e-16 ***
e_untreated["EGFR", ] -0.12518    0.03657  -3.423  0.00115 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7174 on 57 degrees of freedom
Multiple R-squared:  0.1705,    Adjusted R-squared:  0.156 
F-statistic: 11.72 on 1 and 57 DF,  p-value: 0.001152
\end{verbatim}

mode does not fit that well, only 17\% can be disrecped by Her1
expression. Maybe we have to consider all types of Her receptors 1-4!!!
cause the composition of Her1 and Her3/4 play a part when it comes to
bad/good prognoses an therfore could play a role in the GI50 values an
the success of erlotinib treatment.

\hypertarget{milestone-which-pathways-are-affected}{%
\subsection{4. Milestone: Which pathways are
affected?}\label{milestone-which-pathways-are-affected}}

The aim of our last milestone was to identify the pathways which are
most regulated due to erlotinib. We used two methods to create a heatmap
of the pathways. In the first one Supplementary Table S2 from the NCI
TPW was used. In this table 5-15 genes are listed for each of the
pathways. The second method was to use the R package progeny, which
scores 100 genes per pathway to calculate the pathway activity and
should explain better the pathway activity since more data is regarded.

\hypertarget{pathways-according-supplementary-table-s2}{%
\subsubsection{1. Pathways according Supplementary Table
S2}\label{pathways-according-supplementary-table-s2}}

First the genes listed for each pathway were stored in one vector. These
pathway vectors were than combined in one table called pathways.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#assign genes to pathways (as in supplementary material)}
\NormalTok{MAPK <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"AURKA"}\NormalTok{, }\StringTok{"AURKB"}\NormalTok{, }\StringTok{"SON"}\NormalTok{, }\StringTok{"CENPA"}\NormalTok{, }\StringTok{"KIF11"}\NormalTok{, }\StringTok{"DUSP6"}\NormalTok{, }\StringTok{"TPX2"}\NormalTok{, }\StringTok{"EGR1"}\NormalTok{)}
\NormalTok{AKT_PI3K <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"CFLAR"}\NormalTok{, }\StringTok{"XIAP"}\NormalTok{, }\StringTok{"BIRC5"}\NormalTok{, }\StringTok{"BIRC3"}\NormalTok{, }\StringTok{"GADD45A"}\NormalTok{, }\StringTok{"MCL1"}\NormalTok{, }\StringTok{"BCL2"}\NormalTok{, }
              \StringTok{"BCL2L1"}\NormalTok{, }\StringTok{"HIF1A"}\NormalTok{, }\StringTok{"AR"}\NormalTok{, }\StringTok{"STAT3"}\NormalTok{, }\StringTok{"IL6"}\NormalTok{, }\StringTok{"JUN"}\NormalTok{, }\StringTok{"FOS"}\NormalTok{)}
  \CommentTok{#AP1 for AKT_PI3K excluded (genename does not exist in FC)}
  \CommentTok{#do they mean with AP1 these 5 genes? AP1AR, AP1B1, AP1G1, AP1G2, AP1M2, AP1S1, AP1S2}
  \CommentTok{#same problem for VEGF --> VEGFA, VEGFB, VEGFB}
\NormalTok{Cell_Cycle_Checkpoint <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"CHEK1"}\NormalTok{, }\StringTok{"CHEK2"}\NormalTok{, }\StringTok{"TP53"}\NormalTok{, }\StringTok{"MDM2"}\NormalTok{, }\StringTok{"CDKN1A"}\NormalTok{, }\StringTok{"CCNE1"}\NormalTok{, }\StringTok{"CDK2"}\NormalTok{, }
                           \StringTok{"CDC25A"}\NormalTok{, }\StringTok{"SMC1A"}\NormalTok{, }\StringTok{"CCNB1"}\NormalTok{, }\StringTok{"CDK1"}\NormalTok{, }\StringTok{"CDC25B"}\NormalTok{, }\StringTok{"CDC25C"}\NormalTok{, }
                           \StringTok{"PLK1"}\NormalTok{, }\StringTok{"WEE1"}\NormalTok{, }\StringTok{"CCND1"}\NormalTok{)}
\NormalTok{JAK_STAT <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"SOCS1"}\NormalTok{, }\StringTok{"NMI"}\NormalTok{, }\StringTok{"BCL2L1"}\NormalTok{, }\StringTok{"CDKN1A"}\NormalTok{, }\StringTok{"MYC"}\NormalTok{)}
\NormalTok{Immunity_Related <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"BCL2L1"}\NormalTok{, }\StringTok{"XIAP"}\NormalTok{, }\StringTok{"BIRC5"}\NormalTok{, }\StringTok{"CFLAR"}\NormalTok{, }\StringTok{"IL6"}\NormalTok{, }\StringTok{"IL1B"}\NormalTok{, }\StringTok{"TNF"}\NormalTok{)}
  \CommentTok{#PTGS does not exist}
\NormalTok{DNA_repair <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"XRCC6"}\NormalTok{, }\StringTok{"PRKDC"}\NormalTok{, }\StringTok{"DCLRE1C"}\NormalTok{, }\StringTok{"XRCC4"}\NormalTok{, }\StringTok{"LIG4"}\NormalTok{, }\StringTok{"BRCA1"}\NormalTok{, }
                \StringTok{"RAD52"}\NormalTok{, }\StringTok{"BRCA2"}\NormalTok{, }\StringTok{"RAD54L"}\NormalTok{, }\StringTok{"ATM"}\NormalTok{, }\StringTok{"ATR"}\NormalTok{, }\StringTok{"PARP1"}\NormalTok{)}
  \CommentTok{#NHEJ1 does not exist}
\NormalTok{DNA_damage <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"TP53"}\NormalTok{, }\StringTok{"FAS"}\NormalTok{, }\StringTok{"BAX"}\NormalTok{, }\StringTok{"PMAIP1"}\NormalTok{)}
  \CommentTok{#BBC3 & ARG do not exist}
\NormalTok{ER_Stress_Survival <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"HSPA5"}\NormalTok{, }\StringTok{"HSP90B1"}\NormalTok{, }\StringTok{"XBP1"}\NormalTok{, }\StringTok{"P4HB"}\NormalTok{, }\StringTok{"ATF4"}\NormalTok{, }\StringTok{"GADD45A"}\NormalTok{)}
\NormalTok{ER_Stress_Apoptotic_Response <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"ATF3"}\NormalTok{, }\StringTok{"DDIT3"}\NormalTok{, }\StringTok{"TNFRSF10B"}\NormalTok{, }\StringTok{"TRIB3"}\NormalTok{, }\StringTok{"BCL2L11"}\NormalTok{, }\StringTok{"CASP2"}\NormalTok{)}
  \CommentTok{#BBC3 & GADD34 do not exist}
\NormalTok{Apoptosis_extrinsic_activation <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"BID"}\NormalTok{, }\StringTok{"FAS"}\NormalTok{, }\StringTok{"CASP8"}\NormalTok{, }\StringTok{"CASP9"}\NormalTok{, }\StringTok{"APAF1"}\NormalTok{)}
\NormalTok{Apoptosis_intrinsic_activation <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"BAX"}\NormalTok{, }\StringTok{"BAK1"}\NormalTok{, }\StringTok{"BID"}\NormalTok{, }\StringTok{"PMAIP1"}\NormalTok{, }
                                    \StringTok{"CASP6"}\NormalTok{, }\StringTok{"CASP9"}\NormalTok{, }\StringTok{"APAF1"}\NormalTok{)}
  \CommentTok{#BBC3 does not exist}
\NormalTok{Autophagy_recycling_starvation <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"MAP1LC3B"}\NormalTok{, }\StringTok{"ULK1"}\NormalTok{, }\StringTok{"ATG13"}\NormalTok{, }\StringTok{"BECN1"}\NormalTok{, }
                                    \StringTok{"SQSTM1"}\NormalTok{, }\StringTok{"ATG5"}\NormalTok{, }\StringTok{"ATG12"}\NormalTok{, }\StringTok{"CTSB"}\NormalTok{)}
\NormalTok{Autophagy_toxic <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"SQSTM1"}\NormalTok{, }\StringTok{"ATG7"}\NormalTok{, }\StringTok{"RIPK1"}\NormalTok{, }\StringTok{"CTSB"}\NormalTok{)}

\CommentTok{#create named list of all pathways}
\NormalTok{pathways <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\DataTypeTok{MAPK =}\NormalTok{ MAPK, }
                 \DataTypeTok{AKT_PI3K =}\NormalTok{ AKT_PI3K, }
                 \DataTypeTok{Cell_Cycle_Checkpoint =}\NormalTok{ Cell_Cycle_Checkpoint, }
                 \DataTypeTok{JAK_STAT =}\NormalTok{ JAK_STAT,}
                 \DataTypeTok{Immunity_Related =}\NormalTok{ Immunity_Related,}
                 \DataTypeTok{DNA_repair =}\NormalTok{ DNA_repair,}
                 \DataTypeTok{DNA_damage =}\NormalTok{ DNA_damage,}
                 \DataTypeTok{ER_Stress_Survival =}\NormalTok{ ER_Stress_Survival,}
                 \DataTypeTok{ER_Stress_Apoptotic_Response =}\NormalTok{ ER_Stress_Apoptotic_Response,}
                 \DataTypeTok{Apoptosis_extrinsic_activation =}\NormalTok{ Apoptosis_extrinsic_activation, }
                 \DataTypeTok{Apoptosis_intrinsic_activation =}\NormalTok{ Apoptosis_intrinsic_activation, }
                 \DataTypeTok{Autophagy_recycling_starvation =}\NormalTok{ Autophagy_recycling_starvation,}
                 \DataTypeTok{Autophagy_toxic =}\NormalTok{ Autophagy_toxic) }
\KeywordTok{rm}\NormalTok{(MAPK, AKT_PI3K, Cell_Cycle_Checkpoint, JAK_STAT, Immunity_Related, DNA_repair, }
\NormalTok{   DNA_damage, ER_Stress_Survival, ER_Stress_Apoptotic_Response, }
\NormalTok{   Apoptosis_extrinsic_activation, Apoptosis_intrinsic_activation, }
\NormalTok{   Autophagy_recycling_starvation, Autophagy_toxic)}
\end{Highlighting}
\end{Shaded}

This pathway table was then used to create the heatmap\_data table, in
which the mean expression over all genes assigned to a pathway is
calculated for each cellline.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#calculate mean FC over genes of one pathway for each sample}
\NormalTok{heatmap_data <-}\StringTok{ }\KeywordTok{sapply}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(pathways), }\ControlFlowTok{function}\NormalTok{(x)\{ }\CommentTok{#for each pathway}
  \KeywordTok{sapply}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{ncol}\NormalTok{(e_foldchange), }\ControlFlowTok{function}\NormalTok{(y)\{ }\CommentTok{#for each sample}
    \CommentTok{#calculate mean FC of genes of one pathway}
    \KeywordTok{mean}\NormalTok{(e_foldchange[pathways[[x]], y]) }
\NormalTok{  \})}
\NormalTok{\})}

\KeywordTok{colnames}\NormalTok{(heatmap_data) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{names}\NormalTok{(pathways))}
\KeywordTok{rownames}\NormalTok{(heatmap_data) <-}\StringTok{ }\KeywordTok{colnames}\NormalTok{(e_foldchange)}
\end{Highlighting}
\end{Shaded}

Proof how many clusters are needed with an elbow plot

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Elbow plot}
\KeywordTok{library}\NormalTok{(factoextra)}
\KeywordTok{fviz_nbclust}\NormalTok{(heatmap_data, }
             \DataTypeTok{FUN =}\NormalTok{ hcut, }
             \DataTypeTok{method =} \StringTok{"wss"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\CommentTok{#within cluster sums of squares}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Elbow plot: optimal number of cellline clusters"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-35-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{fviz_nbclust}\NormalTok{(}\KeywordTok{t}\NormalTok{(heatmap_data), }
             \DataTypeTok{FUN =}\NormalTok{ hcut, }
             \DataTypeTok{method =} \StringTok{"wss"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Elbow plot: optimal number of pathway clusters"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-35-2} \end{center}

Colored annotation bars above the heatmap should depict several
clusters. Therefore, the dendrogramm was used to first cluster the
celllines and afterwards the pathways. 1. Clustering according to
cellline:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Clustering with package dendextend}
\KeywordTok{library}\NormalTok{(dendextend)}
\CommentTok{#hierachical clustering (hclust) of celllines}
\CommentTok{#dist(): euclidean distance}
\CommentTok{#agglomeration method: "ward.D2"}
\NormalTok{cellline_clustering <-}\StringTok{ }\KeywordTok{hclust}\NormalTok{(}\KeywordTok{dist}\NormalTok{(heatmap_data), }\DataTypeTok{method =} \StringTok{"ward.D2"}\NormalTok{) }
\CommentTok{#cutree: cuts the tree to generate k clusters}
\NormalTok{cellline_groups <-}\StringTok{ }\KeywordTok{cutree}\NormalTok{(}\DataTypeTok{tree =} \KeywordTok{as.dendrogram}\NormalTok{(cellline_clustering), }\DataTypeTok{k =} \DecValTok{3}\NormalTok{)}

\CommentTok{#Create data frame with cancertype for each cellline treated with erlotinib}
\NormalTok{cellline_cancertype <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{sapply}\NormalTok{(}\KeywordTok{names}\NormalTok{(cellline_groups), }\ControlFlowTok{function}\NormalTok{(x)\{ }
  \KeywordTok{unname}\NormalTok{(cellline_annotation[}\KeywordTok{which}\NormalTok{(cellline_annotation}\OperatorTok{$}\NormalTok{Cell_Line_Name }\OperatorTok{==}\StringTok{ }\NormalTok{x), }\DecValTok{2}\NormalTok{])}
\NormalTok{\}))}

\CommentTok{#save clustering according to dendrogramm and cancertype }
\CommentTok{#in a new data frame called cellline_clusters}
\NormalTok{cellline_clusters <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(cellline_groups, cellline_cancertype))}
\KeywordTok{colnames}\NormalTok{(cellline_clusters) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Cellline cluster"}\NormalTok{, }\StringTok{"Cancertype cluster"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Clustering according to pathways:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#cluster pathways: }
\NormalTok{pathway_clustering <-}\StringTok{ }\KeywordTok{hclust}\NormalTok{(}\KeywordTok{dist}\NormalTok{(}\KeywordTok{t}\NormalTok{(heatmap_data)), }\DataTypeTok{method =} \StringTok{"ward.D2"}\NormalTok{) }
\NormalTok{pathway_groups <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cutree}\NormalTok{(}\DataTypeTok{tree =} \KeywordTok{as.dendrogram}\NormalTok{(pathway_clustering), }\DataTypeTok{k =} \DecValTok{3}\NormalTok{))}
\KeywordTok{colnames}\NormalTok{(pathway_groups) <-}\StringTok{ "Pathway cluster"}
\end{Highlighting}
\end{Shaded}

Create a heatmap with the package pheatmap (pretty heatmap):

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(pheatmap)}
\CommentTok{#generate heatmap with colored bars according to clusters}
\KeywordTok{pheatmap}\NormalTok{(}\KeywordTok{t}\NormalTok{(heatmap_data),}
         \DataTypeTok{clustering_method =} \StringTok{"ward.D2"}\NormalTok{,}
         \DataTypeTok{annotation_col =}\NormalTok{ cellline_clusters,}
         \DataTypeTok{annotation_row =}\NormalTok{ pathway_groups,}
         \DataTypeTok{cutree_rows =} \DecValTok{3}\NormalTok{, }\CommentTok{#makes white spaces between clusters}
         \DataTypeTok{cutree_cols =} \DecValTok{3}\NormalTok{,}
         \DataTypeTok{main =} \StringTok{"Affected pathways by erlotinib"}\NormalTok{,}
         \DataTypeTok{mainsize =} \FloatTok{1.2}\NormalTok{,}
         \DataTypeTok{show_colnames =} \OtherTok{FALSE}\NormalTok{,}
         \DataTypeTok{cellwidth =} \DecValTok{4}\NormalTok{,}
         \DataTypeTok{cellheight =} \DecValTok{15}\NormalTok{, }
         \DataTypeTok{fontsize =} \DecValTok{10}\NormalTok{,}
         \DataTypeTok{fontsize_row =} \DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-38-1} \end{center}

\hypertarget{heatmap-with-progeny}{%
\subsubsection{2. Heatmap with PROGENy}\label{heatmap-with-progeny}}

Using PROGENY, which scores the 100 most important genes for each
pathway to depict its activity.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(progeny)}
\NormalTok{progeny_heatmap <-}\StringTok{ }\KeywordTok{progeny}\NormalTok{(e_foldchange)}
\end{Highlighting}
\end{Shaded}

Proof how many clusters are needed with an elbow plot

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Elbow plot}
\KeywordTok{library}\NormalTok{(factoextra)}
\KeywordTok{fviz_nbclust}\NormalTok{(progeny_heatmap, }
             \DataTypeTok{FUN =}\NormalTok{ hcut, }
             \DataTypeTok{method =} \StringTok{"wss"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\CommentTok{#within cluster sums of squares}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Elbow plot: optimal number of cellline clusters"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-40-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{fviz_nbclust}\NormalTok{(}\KeywordTok{t}\NormalTok{(progeny_heatmap), }
             \DataTypeTok{FUN =}\NormalTok{ hcut, }
             \DataTypeTok{method =} \StringTok{"wss"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Elbow plot: optimal number of pathway clusters"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-40-2} \end{center}

Clustering according to cellline and pathway

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#cluster celllines:}
\NormalTok{cellline_clustering <-}\StringTok{ }\KeywordTok{hclust}\NormalTok{(}\KeywordTok{dist}\NormalTok{(progeny_heatmap), }\DataTypeTok{method =} \StringTok{"ward.D2"}\NormalTok{)}
\NormalTok{cellline_groups <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cutree}\NormalTok{(}\DataTypeTok{tree =} \KeywordTok{as.dendrogram}\NormalTok{(cellline_clustering), }\DataTypeTok{k =} \DecValTok{2}\NormalTok{))}
\NormalTok{cellline_clusters <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cbind}\NormalTok{(cellline_groups, cellline_cancertype))}
\KeywordTok{colnames}\NormalTok{(cellline_clusters) <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Cellline cluster"}\NormalTok{, }\StringTok{"Cancertype cluster"}\NormalTok{)}
\CommentTok{#cluster pathways:}
\NormalTok{pathway_clustering <-}\StringTok{ }\KeywordTok{hclust}\NormalTok{(}\KeywordTok{dist}\NormalTok{(}\KeywordTok{t}\NormalTok{(progeny_heatmap)), }\DataTypeTok{method =} \StringTok{"ward.D2"}\NormalTok{) }
\NormalTok{pathway_groups <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{cutree}\NormalTok{(}\DataTypeTok{tree =} \KeywordTok{as.dendrogram}\NormalTok{(pathway_clustering), }\DataTypeTok{k =} \DecValTok{2}\NormalTok{))}
\KeywordTok{colnames}\NormalTok{(pathway_groups) <-}\StringTok{ "Pathway cluster"}
\end{Highlighting}
\end{Shaded}

Create heatmap

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{par}\NormalTok{(}\DataTypeTok{mar =} \KeywordTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\KeywordTok{pheatmap}\NormalTok{(}\KeywordTok{t}\NormalTok{(progeny_heatmap),}
         \DataTypeTok{clustering_method =} \StringTok{"ward.D2"}\NormalTok{,}
         \DataTypeTok{annotation_col =}\NormalTok{ cellline_clusters,}
         \DataTypeTok{annotation_row =}\NormalTok{ pathway_groups,}
         \DataTypeTok{cutree_rows =} \DecValTok{2}\NormalTok{,}
         \DataTypeTok{cutree_cols =} \DecValTok{2}\NormalTok{,}
         \DataTypeTok{main =} \StringTok{"Affected pathways by erlotinib (PROGENy)"}\NormalTok{,}
         \DataTypeTok{mainsize =} \FloatTok{1.2}\NormalTok{, }
         \DataTypeTok{show_colnames =} \OtherTok{FALSE}\NormalTok{,}
         \DataTypeTok{cellwidth =} \DecValTok{5}\NormalTok{,}
         \DataTypeTok{cellheight =} \DecValTok{20}\NormalTok{, }
         \DataTypeTok{fontsize =} \DecValTok{10}\NormalTok{,}
         \DataTypeTok{fontsize_row =} \DecValTok{14}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Markdown_all_milestones_files/figure-latex/unnamed-chunk-42-1} \end{center}


\end{document}
